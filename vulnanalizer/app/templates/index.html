{% extends "base.html" %}

{% block title %}VulnAnalizer - Анализ уязвимостей{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="/static/css/pages/vulnanalizer.css?v=4.4">
{% endblock %}

{% block ui_manager_js %}
    <script src="/static/js/ui-manager.js?v=6.1"></script>
{% endblock %}

<!-- Используем обработчики из base.html -->

{% block sidebar_tabs %}
<a href="#" class="sidebar-tab active" data-page="analysis">
    <div class="sidebar-tab-icon">
        <i class="fas fa-search-plus"></i>
    </div>
    <span class="sidebar-tab-title">Поиск</span>
</a>
<a href="#" class="sidebar-tab" data-page="hosts">
    <div class="sidebar-tab-icon">
        <i class="fas fa-database"></i>
    </div>
    <span class="sidebar-tab-title">Импорт</span>
</a>
<a href="#" class="sidebar-tab" data-page="settings">
    <div class="sidebar-tab-icon">
        <i class="fas fa-sliders-h"></i>
    </div>
    <span class="sidebar-tab-title">Настройки</span>
</a>
{% endblock %}

{% block content %}
<!-- Основной контент -->
<main class="main-content">
    <div class="page-container">
        <!-- Страница анализа -->
        <div id="analysis-page" class="page-content active">
            <div class="analysis-container content-block">
                <div class="hosts-search-form">
                    <h3>Критерии поиска</h3>
                    <form id="hosts-search-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="hostname-search">Имя хоста:</label>
                                <input type="text" id="hostname-search" name="hostname" placeholder="server.example.com">
                            </div>
                            <div class="form-group">
                                <label for="ip-search">IP адрес:</label>
                                <input type="text" id="ip-search" name="ip_address" placeholder="192.168.1.1">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cve-host-search">CVE:</label>
                                <input type="text" id="cve-host-search" name="cve" placeholder="CVE-2021-44228">
                            </div>
                            <div class="form-group">
                                <label for="criticality-search">Критичность:</label>
                                <select id="criticality-search" name="criticality">
                                    <option value="">Все</option>
                                    <option value="Critical">Critical</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group checkbox-group">
                                <input type="checkbox" id="exploits-only" name="exploits_only">
                                <label for="exploits-only">Только с эксплойтами</label>
                            </div>
                            <div class="form-group checkbox-group">
                                <input type="checkbox" id="epss-only" name="epss_only">
                                <label for="epss-only">Только с EPSS</label>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="results-per-page">Записей на странице:</label>
                                <select id="results-per-page" name="limit">
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="100" selected>100</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="sort-by">Сортировка:</label>
                                <select id="sort-by" name="sort_by">
                                    <option value="">По умолчанию</option>
                                    <option value="risk_score_desc">По риску (убывание)</option>
                                    <option value="risk_score_asc">По риску (возрастание)</option>
                                    <option value="cvss_desc">По CVSS (убывание)</option>
                                    <option value="cvss_asc">По CVSS (возрастание)</option>
                                    <option value="epss_score_desc">По EPSS (убывание)</option>
                                    <option value="epss_score_asc">По EPSS (возрастание)</option>
                                    <option value="exploits_count_desc">По количеству эксплойтов (убывание)</option>
                                    <option value="exploits_count_asc">По количеству эксплойтов (возрастание)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-sm">
                                <i class="fas fa-search"></i> Найти
                            </button>
                            <button type="button" id="clear-hosts-results" class="btn btn-secondary btn-sm">
                                <i class="fas fa-times"></i> Очистить
                            </button>
                            <button type="button" id="export-hosts" class="btn btn-success btn-sm">
                                <i class="fas fa-file-excel"></i> Экспорт в Excel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Отдельный контейнер для результатов поиска -->
            <div class="hosts-search-results-container content-block content-block-no-margin">
                <!-- Заголовок таблицы с подписями колонок -->
                <div class="hosts-table-header">
                    <div class="host-item single-line">
                        <div class="host-name">Host</div>
                        <div class="host-ip">IP</div>
                        <div class="host-criticality">Severity</div>
                        <div class="host-cve">CVE</div>
                        <div class="host-cvss">CVSS</div>
                        <div class="host-status">EPSS</div>
                        <div class="host-exploits">PoC</div>
                        <div class="host-risk">Risk</div>
                    </div>
                </div>
                <div id="hosts-search-results" class="hosts-results">
                    <!-- Результаты поиска хостов будут загружены динамически -->
                </div>
                <!-- Пагинация -->
                <div id="hosts-pagination" class="pagination-container" style="display: none;">
                    <div class="pagination-info">
                        <span id="pagination-info">Показано 0 из 0 записей</span>
                    </div>
                    <div class="pagination-controls">
                        <button id="prev-page" class="btn btn-secondary btn-sm" disabled>
                            <i class="fas fa-chevron-left"></i> Предыдущая
                        </button>
                        <span id="page-numbers" class="page-numbers"></span>
                        <button id="next-page" class="btn btn-secondary btn-sm" disabled>
                            Следующая <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Страница импорта хостов -->
        <div id="hosts-page" class="page-content">
            <div class="content-header">
                <h2>Импорт хостов</h2>
                <p>Загрузка и обработка данных о хостах</p>
            </div>
            
            <div class="hosts-container content-block">
                <h3><i class="fas fa-server"></i> Импорт хостов из MP VM</h3>
                <form id="hosts-upload-form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="hosts-file">Загрузить файл хостов:</label>
                        <input type="file" id="hosts-file" name="file" accept=".csv,.zip,.gz,.gzip" required>
                        <small>Поддерживаемые форматы: CSV, ZIP, GZIP</small>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-sm" id="hosts-upload-btn">
                            <i class="fas fa-upload"></i> <span class="btn-text">Загрузить CSV</span>
                            <i class="fas fa-spinner fa-spin" style="display:none;"></i>
                        </button>

                        <button type="button" id="update-hosts-parallel-btn" class="btn btn-primary btn-sm">
                            <i class="fas fa-sync-alt"></i> <span class="btn-text">Полное обновление</span>
                            <i class="fas fa-spinner fa-spin" style="display:none;"></i>
                        </button>
                        <button type="button" id="cancel-update-btn" class="btn btn-danger btn-sm" style="display:none;">
                            <i class="fas fa-stop"></i> <span class="btn-text">Остановить обновление</span>
                        </button>
                    </div>
                </form>
                <div id="hosts-status" style="margin-top:2rem;"></div>
                
                <!-- Прогресс-бар импорта -->
                <div id="import-progress-container" style="display:none; margin-top:2rem;">
                    <h4>Прогресс импорта</h4>
                    <div class="operation-status">
                        <div class="operation-step">
                            <span id="current-step-text">Подготовка...</span>
                        </div>
                        <div class="operation-progress-bar">
                            <div id="progress-bar-fill" class="operation-progress-fill" style="width: 0%"></div>
                            <div class="operation-progress-text" id="overall-progress-text">0%</div>
                        </div>
                        <div class="operation-details">
                            <div class="operation-item">
                                <span class="operation-label">Всего записей:</span>
                                <span id="total-records-text">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Прогресс фонового обновления -->
                <div id="background-update-progress-container" style="display:none; margin-top:2rem;">
                    <h4>Прогресс обновления данных</h4>
                    <div class="operation-status">
                        <div class="operation-step">
                            <span id="background-current-step-text">Инициализация...</span>
                        </div>
                        <div class="operation-progress-bar">
                            <div id="background-progress-bar-fill" class="operation-progress-fill" style="width: 0%"></div>
                            <div class="operation-progress-text" id="background-overall-progress-text">0%</div>
                        </div>
                        <div class="operation-details">
                            <div class="operation-item">
                                <span class="operation-label">Обработано CVE:</span>
                                <span id="background-processed-cves-text">0</span>
                            </div>
                            <div class="operation-item">
                                <span class="operation-label">Всего CVE:</span>
                                <span id="background-total-cves-text">0</span>
                            </div>
                            <div class="operation-item">
                                <span class="operation-label">Обновлено хостов:</span>
                                <span id="background-updated-hosts-text">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Страница настроек -->
        <div id="settings-page" class="page-content">
            <div class="content-header">
                <h2>Настройки</h2>
                <p>Конфигурация системы</p>
            </div>
            
            <div class="settings-container">
                <!-- Настройки производительности -->
                <div class="content-block">
                    <h3><i class="fas fa-tachometer-alt"></i> Настройки производительности</h3>
                    <form id="performance-form">
                        <div class="form-group">
                            <label for="vulnanalizer-max-concurrent-requests">Максимум одновременных запросов к БД:</label>
                            <input type="number" id="vulnanalizer-max-concurrent-requests" name="max_concurrent_requests" min="1" max="10" value="3" required>
                            <small>Рекомендуется: 1-5. Больше запросов = быстрее, но больше нагрузка на БД</small>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-sm">
                                <i class="fas fa-save"></i> Сохранить
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Настройки Impact -->
                <div class="content-block">
                    <h3>
                        <i class="fas fa-chart-line"></i> Расчет риска (Impact)
                        <button type="button" class="btn btn-link btn-sm formula-btn" id="show-risk-formula" title="Показать формулу расчета">
                            <i class="fas fa-square-root-alt"></i>
                        </button>
                    </h3>
                    <form id="impact-form">
                        <div class="form-group">
                            <label for="impact-resource-criticality">Критичность ресурса:</label>
                            <select id="impact-resource-criticality" name="impact_resource_criticality" required>
                                <option value="Critical">Critical (0.33)</option>
                                <option value="High">High (0.25)</option>
                                <option value="Medium">Medium (0.15)</option>
                                <option value="None">None (0.1)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="impact-confidential-data">Наличие конфиденциальных данных:</label>
                            <select id="impact-confidential-data" name="impact_confidential_data" required>
                                <option value="Есть">Есть (0.33)</option>
                                <option value="Отсутствуют">Отсутствуют (0.1)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="impact-internet-access">Доступен из сети интернет:</label>
                            <select id="impact-internet-access" name="impact_internet_access" required>
                                <option value="Доступен">Доступен (0.33)</option>
                                <option value="Недоступен">Недоступен (0.1)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="risk-threshold">Порог риска (красная зона): <span id="threshold-value">75</span>%</label>
                            <input type="range" id="risk-threshold" name="risk_threshold" min="0" max="100" value="75" class="threshold-slider">
                        </div>
                        <div class="form-group">
                            <label for="max-concurrent-requests">Максимум одновременных запросов к БД:</label>
                            <input type="number" id="max-concurrent-requests" name="max_concurrent_requests" min="1" max="10" value="3" required>
                            <small>Рекомендуется: 1-5. Больше запросов = быстрее, но больше нагрузка на БД</small>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-sm">
                                <i class="fas fa-save"></i> Сохранить Impact
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Настройки VM MaxPatrol -->
                <div class="content-block">
                    <h3><i class="fas fa-server"></i> Интеграция с MaxPatrol VM</h3>
                    <form id="vm-settings-form">
                        <div class="form-group">
                            <label for="vm-enabled">Включить интеграцию:</label>
                            <select id="vm-enabled" name="vm_enabled" required>
                                <option value="false">Отключено</option>
                                <option value="true">Включено</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="vm-host">Хост VM:</label>
                            <input type="text" id="vm-host" name="vm_host" placeholder="msk01vm23.corp.local" required>
                            <small>Адрес сервера MaxPatrol VM</small>
                        </div>
                        <div class="form-group">
                            <label for="vm-username">Имя пользователя:</label>
                            <input type="text" id="vm-username" name="vm_username" placeholder="username" required>
                            <small>Логин для доступа к VM API</small>
                        </div>
                        <div class="form-group">
                            <label for="vm-password">Пароль:</label>
                            <input type="password" id="vm-password" name="vm_password" placeholder="password" required>
                            <small>Пароль для доступа к VM API</small>
                        </div>
                        <div class="form-group">
                            <label for="vm-client-secret">Client Secret:</label>
                            <input type="password" id="vm-client-secret" name="vm_client_secret" placeholder="client_secret" required>
                            <small>Секретный ключ для OAuth2 аутентификации</small>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-sm" id="vm-settings-btn">
                                <i class="fas fa-save"></i> Сохранить VM
                            </button>
                            <button type="button" id="vm-test-connection-btn" class="btn btn-info">
                                <i class="fas fa-plug"></i> Тест подключения
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- EPSS -->
                <div class="epss-container content-block">
                    <h3>Загрузка базы EPSS</h3>
                    <form id="epss-upload-form" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="epss-file">Загрузить CSV-файл:</label>
                            <input type="file" id="epss-file" name="file" accept=".csv" required>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-sm" id="epss-upload-btn">
                                <i class="fas fa-upload"></i> <span class="btn-text">Загрузить CSV</span>
                                <i class="fas fa-spinner fa-spin" style="display:none;"></i>
                            </button>
                            <button type="button" id="epss-download-btn" class="btn btn-primary btn-sm">
                                <i class="fas fa-cloud-download-alt"></i> <span class="btn-text">Скачать с сайта</span>
                                <i class="fas fa-spinner fa-spin" style="display:none;"></i>
                            </button>
                        </div>
                    </form>
                    <div id="epss-status" style="margin-top:2rem;"></div>
                </div>

                <!-- ExploitDB -->
                <div class="exploitdb-container content-block">
                    <h3>Загрузка базы ExploitDB</h3>
                    <form id="exploitdb-upload-form" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="exploitdb-file">Загрузить CSV-файл:</label>
                            <input type="file" id="exploitdb-file" name="file" accept=".csv" required>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-sm" id="exploitdb-upload-btn">
                                <i class="fas fa-upload"></i> <span class="btn-text">Загрузить CSV</span>
                                <i class="fas fa-spinner fa-spin" style="display:none;"></i>
                            </button>
                            <button type="button" id="exploitdb-download-btn" class="btn btn-primary btn-sm">
                                <i class="fas fa-cloud-download-alt"></i> <span class="btn-text">Скачать с сайта</span>
                                <i class="fas fa-spinner fa-spin" style="display:none;"></i>
                            </button>
                        </div>
                    </form>
                    <div id="exploitdb-status" style="margin-top:2rem;"></div>
                </div>

                <!-- CVE -->
                <div class="cve-container content-block">
                    <h3><i class="fas fa-bug"></i> Управление базой CVE</h3>
                    
                    <!-- Выбор лет для загрузки -->
                    <div class="form-group mb-3">
                        <button type="button" class="btn btn-outline-primary btn-sm dropdown-toggle" id="toggle-year-selector">
                            <i class="fas fa-calendar"></i> Выбрать годы для загрузки
                            <i class="fas fa-chevron-down ms-1"></i>
                        </button>
                        <div class="year-selector" id="year-selector" style="display: none;">
                            <div class="year-grid" id="year-grid">
                                <!-- Годы будут добавлены через JavaScript -->
                            </div>
                            <div class="year-controls mt-2">
                                <button type="button" class="btn btn-sm btn-outline-secondary" id="select-all-years">
                                    Выбрать все
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-secondary" id="select-recent-years">
                                    Последние 5 лет
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-secondary" id="clear-years">
                                    Очистить
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Кнопки управления -->
                    <div class="form-actions">
                        <button id="download-cve-btn" class="btn btn-primary btn-sm">
                            <i class="fas fa-download"></i> Загрузить CVE
                        </button>
                        <button id="cancel-cve-btn" class="btn btn-danger btn-sm" style="display: none;">
                            <i class="fas fa-stop"></i> Отменить загрузку
                        </button>
                        <button type="button" id="cve-urls-btn" class="btn btn-info btn-sm">
                            <i class="fas fa-link"></i> Ссылки для скачивания
                        </button>
                    </div>
                    
                    <!-- Статус загрузки -->
                    <div id="cve-status" class="mt-3"></div>
                    
                    <!-- CVE Status -->
                    <div class="mt-4">
                        <h4><i class="fas fa-info-circle"></i> Статус базы CVE</h4>
                        <div id="cve-count"></div>
                    </div>
                    
                    <!-- Загрузка файлов (legacy) -->
                    <div class="mt-4">
                        <h4><i class="fas fa-upload"></i> Загрузка файлов</h4>
                        <form id="cve-upload-form" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="cve-file">Загрузить JSON-файл:</label>
                                <input type="file" id="cve-file" name="file" accept=".json,.gz" required>
                                <small>Поддерживаемые форматы: JSON, GZ (архив)</small>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary btn-sm" id="cve-upload-btn">
                                    <i class="fas fa-upload"></i> <span class="btn-text">Загрузить файл</span>
                                    <i class="fas fa-spinner fa-spin" style="display:none;"></i>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Очистка таблиц -->
                <div class="clear-container content-block">
                    <h3>Очистка таблиц</h3>
                    <div class="clear-actions">
                        <div class="clear-item">
                            <h4>Хосты</h4>
                            <p>Удалить все записи хостов из базы данных</p>
                            <button type="button" id="clear-hosts-btn" class="btn btn-danger btn-sm">
                                <i class="fas fa-trash"></i> Очистить хосты
                            </button>
                        </div>
                        <div class="clear-item">
                            <h4>EPSS</h4>
                            <p>Удалить все записи EPSS из базы данных</p>
                            <button type="button" id="clear-epss-btn" class="btn btn-danger btn-sm">
                                <i class="fas fa-trash"></i> Очистить EPSS
                            </button>
                        </div>
                        <div class="clear-item">
                            <h4>ExploitDB</h4>
                            <p>Удалить все записи ExploitDB из базы данных</p>
                            <button type="button" id="clear-exploitdb-btn" class="btn btn-danger btn-sm">
                                <i class="fas fa-trash"></i> Очистить ExploitDB
                            </button>
                        </div>
                        <div class="clear-item">
                            <h4>CVE</h4>
                            <p>Удалить все записи CVE из базы данных</p>
                            <button type="button" id="clear-cve-btn" class="btn btn-danger btn-sm">
                                <i class="fas fa-trash"></i> Очистить CVE
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Модальное окно с формулой расчета риска -->
<div id="risk-formula-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-square-root-alt"></i> Формула расчета риска</h3>
            <button type="button" class="modal-close" id="close-risk-formula">&times;</button>
        </div>
        <div class="modal-body">
            <div class="formula-section">
                <h4>🎯 Основная формула</h4>
                <div class="formula-box">
                    <div class="formula-main">
                        <span class="formula-text">Risk = EPSS × (CVSS ÷ 10) × Impact</span>
                    </div>
                    <div class="formula-note">
                        Где: <strong>Risk</strong> - итоговый риск в процентах (0-100%)
                    </div>
                </div>
            </div>

            <div class="formula-section">
                <h4>📊 Расчет Impact</h4>
                <div class="formula-box">
                    <div class="formula-main">
                        <span class="formula-text">Impact = Resource_Criticality + Confidential_Data + Internet_Access</span>
                    </div>
                </div>
                
                <div class="impact-weights">
                    <div class="weight-group">
                        <h5>⚖️ Критичность ресурса:</h5>
                        <ul>
                            <li><strong>Critical:</strong> 0.33</li>
                            <li><strong>High:</strong> 0.25</li>
                            <li><strong>Medium:</strong> 0.15</li>
                            <li><strong>None:</strong> 0.1</li>
                        </ul>
                    </div>
                    
                    <div class="weight-group">
                        <h5>🔒 Конфиденциальные данные:</h5>
                        <ul>
                            <li><strong>Есть:</strong> 0.33</li>
                            <li><strong>Отсутствуют:</strong> 0.1</li>
                        </ul>
                    </div>
                    
                    <div class="weight-group">
                        <h5>🌐 Доступ из интернета:</h5>
                        <ul>
                            <li><strong>Доступен:</strong> 0.33</li>
                            <li><strong>Недоступен:</strong> 0.1</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="formula-section">
                <h4>📈 Пример расчета</h4>
                <div class="example-box">
                    <div class="example-data">
                        <p><strong>Исходные данные:</strong></p>
                        <ul>
                            <li>EPSS = 0.5 (50% вероятность эксплуатации)</li>
                            <li>CVSS = 8.0 (высокая критичность)</li>
                            <li>Критичность ресурса = Critical (0.33)</li>
                            <li>Конфиденциальные данные = Есть (0.33)</li>
                            <li>Доступ из интернета = Доступен (0.33)</li>
                        </ul>
                    </div>
                    
                    <div class="example-calculation">
                        <p><strong>Расчет:</strong></p>
                        <div class="calculation-steps">
                            <div class="step">1. Impact = 0.33 + 0.33 + 0.33 = <strong>0.99</strong></div>
                            <div class="step">2. Risk = 0.5 × (8.0 ÷ 10) × 0.99 = <strong>0.396</strong></div>
                            <div class="step">3. Risk Score = min(1, 0.396) × 100 = <strong>39.6%</strong></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="formula-section">
                <h4>🎚️ Шкала риска</h4>
                <div class="risk-scale">
                    <div class="risk-level low">
                        <span class="level-name">Низкий риск</span>
                        <span class="level-range">0-20%</span>
                    </div>
                    <div class="risk-level medium">
                        <span class="level-name">Средний риск</span>
                        <span class="level-range">20-40%</span>
                    </div>
                    <div class="risk-level high">
                        <span class="level-name">Высокий риск</span>
                        <span class="level-range">40-70%</span>
                    </div>
                    <div class="risk-level critical">
                        <span class="level-name">Критический риск</span>
                        <span class="level-range">70-100%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Уведомления -->
<div id="notifications" class="notifications"></div>

<!-- Скрипты -->
    <script src="/vulnanalizer/static/js/modules/notifications.js?v=2.1"></script>
<script src="/vulnanalizer/static/js/modules/api.js?v=2.4"></script>
<script src="/vulnanalizer/static/js/modules/auth.js?v=2.0"></script>
    <script src="/vulnanalizer/static/js/modules/hosts.js?v=3.2"></script>
<script src="/vulnanalizer/static/js/modules/epss.js?v=2.0"></script>
<script src="/vulnanalizer/static/js/modules/exploitdb.js?v=2.0"></script>
<script src="/vulnanalizer/static/js/modules/cve.js?v=2.0"></script>
<script src="/vulnanalizer/static/js/modules/cve-manager.js?v=1.0"></script>
    <script src="/vulnanalizer/static/js/modules/settings.js?v=2.1"></script>
<script src="/vulnanalizer/static/js/modules/vm.js?v=2.0"></script>
<script src="/vulnanalizer/static/js/modules/navigation.js?v=2.0"></script>
<script src="/vulnanalizer/static/js/modules/utils.js?v=2.0"></script>
    <script src="/vulnanalizer/static/js/app.js?v=5.5"></script>


{% endblock %}
