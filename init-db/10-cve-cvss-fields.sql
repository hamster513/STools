-- Добавление новых полей CVSS в таблицу CVE
-- CVSS v3.1 дополнительные поля
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v3_attack_vector VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v3_privileges_required VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v3_user_interaction VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v3_confidentiality_impact VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v3_integrity_impact VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v3_availability_impact VARCHAR(20);

-- CVSS v2 дополнительные поля
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v2_access_vector VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v2_access_complexity VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v2_authentication VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v2_confidentiality_impact VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v2_integrity_impact VARCHAR(20);
ALTER TABLE vulnanalizer.cve ADD COLUMN IF NOT EXISTS cvss_v2_availability_impact VARCHAR(20);

-- Индексы для новых полей
CREATE INDEX IF NOT EXISTS idx_cve_cvss_v3_attack_vector ON vulnanalizer.cve(cvss_v3_attack_vector);
CREATE INDEX IF NOT EXISTS idx_cve_cvss_v3_privileges_required ON vulnanalizer.cve(cvss_v3_privileges_required);
CREATE INDEX IF NOT EXISTS idx_cve_cvss_v3_user_interaction ON vulnanalizer.cve(cvss_v3_user_interaction);
CREATE INDEX IF NOT EXISTS idx_cve_cvss_v2_access_vector ON vulnanalizer.cve(cvss_v2_access_vector);
CREATE INDEX IF NOT EXISTS idx_cve_cvss_v2_access_complexity ON vulnanalizer.cve(cvss_v2_access_complexity);
CREATE INDEX IF NOT EXISTS idx_cve_cvss_v2_authentication ON vulnanalizer.cve(cvss_v2_authentication);
